
## Результаты применения кэширования

Здесь я привожу результаты для разных запросов и для разных бд: для своей и тестовой через testcontainers,
важное замечаение, что таблица заказов содержит в себе 100000+- заказов, а в таблице админов
всего 1 запись, если было бы больше, вероятно, это повлияло бы на то, как влияет кэш админов на производительность

### Описание строк таблицы
1. Бд + кэш заказов + кэш админов
2. Бд + кэш заказов
3. Бд + кэш админов
4. Бд без кэшей

# 1-ая часть

`go test -bench . -benchtime=NUMBERx -benchmem`, где `NUMBER` – количество запросов

### Результаты бенчмарков для пути `/orders?count=1`
`go test -bench . -benchtime=10000x -benchmem`

| Время (ns/op) | Память (B/op) | Аллокации (allocs/op) |
|---------------|---------------|-----------------------|
| 12245237      | 1403174       | 210                   |
| 12271901      | 1415583       | 279                   |
| 12263217      | 36499         | 355                   |
| 12368227      | 39273         | 429                   |

---

### Результаты бенчмарков для пути `/orders?count=100`

`go test -bench . -benchtime=200x -benchmem`

| Время (ns/op) | Память (B/op) | Аллокации (allocs/op) |
|---------------|---------------|-----------------------|
| 11133647      | 1511917       | 932                   |
| 11179878      | 1517276       | 1000                  |
| 11450385      | 189946        | 1585                  |
| 11441486      | 193446        | 1658                  |

---

### Результаты бенчмарков для пути `/orders?count=1000`

`go test -bench . -benchtime=100x -benchmem`

| Время (ns/op) | Память (B/op) | Аллокации (allocs/op) |
|---------------|---------------|-----------------------|
| 12199030      | 2721268       | 7234                  |
| 12961820      | 2777115       | 7309                  |
| 12662247      | 1797540       | 12411                 |
| 13819077      | 1690826       | 12486                 |

---

### Результаты бенчмарков для пути `/orders?count=10000`

`go test -bench . -benchtime=100x -benchmem`

| Время (ns/op) | Память (B/op) | Аллокации (allocs/op) |
|---------------|---------------|-----------------------|
| 14550872      | 13171565      | 70007                 |
| 14559755      | 13370978      | 70095                 |
| 21896604      | 22895790      | 120374                |
| 22220836      | 23502380      | 120439                |

---

### Результаты бенчмарков для пути `/orders`

`go test -bench . -benchtime=100x -benchmem`

| Время (ns/op) | Память (B/op) | Аллокации (allocs/op) |
|---------------|---------------|-----------------------|
| 17560905      | 12980851      | 70214                 |
| 18872092      | 12570992      | 70295                 |
| 105346690     | 238215997     | 1199381               |
| 105633360     | 236236063     | 1199491               |


---

# 2-ая часть
Здесь я провёл тот же самый тест, но на своей «боевой» базе. Сервер с базой находится где-то в Нидерландах,
поэтому каждый запрос к базе на вес золота, привёл этот случай, потому кэш отрабатывает на максимум

Здесь используется такая команда

`go test -bench . -benchtime=20s -benchmem`

### Результаты бенчмарков для пути `/orders?count=1`

| Запросы (count) | Время (ns/op) | Память (B/op) | Аллокации (allocs/op) |
|-----------------|---------------|---------------|-----------------------|
| 2002            | 11898139      | 1401779       | 207                   |
| 868             | 28120401      | 1409882       | 279                   |
| 1185            | 19036761      | 37057         | 358                   |
| 624             | 38388106      | 39998         | 435                   |

---

### Результаты бенчмарков для пути `/orders?count=100`

| Запросы (count) | Время (ns/op) | Память (B/op) | Аллокации (allocs/op) |
|-----------------|---------------|---------------|-----------------------|
| 1930            | 12961444      | 1496929       | 905                   |
| 778             | 28902678      | 1490660       | 977                   |
| 1087            | 22299846      | 183968        | 1568                  |
| 577             | 45914791      | 186040        | 1645                  |

---

### Результаты бенчмарков для пути `/orders?count=1000`

| Запросы (count) | Время (ns/op) | Память (B/op) | Аллокации (allocs/op) |
|-----------------|---------------|---------------|-----------------------|
| 1960            | 11521170      | 2647762       | 7192                  |
| 813             | 28765502      | 2378191       | 7260                  |
| 652             | 36735816      | 1601425       | 12365                 |
| 402             | 51603070      | 1640638       | 12444                 |

---

### Результаты бенчмарков для пути `/orders?count=10000`

| Запросы (count) | Время (ns/op) | Память (B/op) | Аллокации (allocs/op) |
|-----------------|---------------|---------------|-----------------------|
| 1657            | 14271045      | 13594228      | 69991                 |
| 748             | 30121556      | 13178796      | 70067                 |
| 153             | 147195127     | 23345140      | 120353                |
| 135             | 163698487     | 22633254      | 120429                |

---

### Результаты бенчмарков для пути `/orders`

| Запросы (count) | Время (ns/op) | Память (B/op) | Аллокации (allocs/op) |
|-----------------|---------------|---------------|-----------------------|
| 777             | 27685722      | 13598302      | 72690                 |
| 429             | 52414318      | 13512885      | 72767                 |
| 7               | 3394862060    | 226695241     | 1202263               |
| 6               | 3993704597    | 223513057     | 1202299               |


---

### Аннотации

1. **Время исполнения (`ns/op`)**:
    - Для всех путей время выполнения минимально для кэшированных запросов и увеличивается при отсутствии кэша, особенно для путей с большим количеством данных (например, `/orders?count=10000`).
    - Путь `/orders` имеет значительно большее время выполнения по сравнению с другими путями из-за гораздо большего объема данных, обрабатываемых запросом.

2. **Память (`B/op`)**:
    - Память для кэшированных запросов меньше по сравнению с запросами без кэша.
    - При увеличении объема данных (например, на пути `/orders?count=10000`) объем используемой памяти значительно возрастает.

3. **Аллокации (`allocs/op`)**:
    - Количество аллокаций также растет с увеличением объема данных, особенно в запросах без кэша и при больших объемах данных.
    - Путь `/orders` имеет наибольшее количество аллокаций из-за больших объемов данных, а также тесты без кэша требуют больше аллокаций.

---

### Вывод

**Кэширование сильно улучшает производительность**